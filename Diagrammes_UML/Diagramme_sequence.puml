@startuml
title Diagramme de Séquence - Mode Console

actor Utilisateur
participant "GameRunner" as Runner
participant "FileReader" as Reader
participant "Game" as Game
participant "GridUpdater" as Updater
participant "Grid" as Grid
participant "StandardRule" as Rule
participant "FileWriter" as Writer

Utilisateur -> Runner : run()
activate Runner

Runner -> Reader : read("input.txt")
activate Reader
Reader --> Runner : Grid initiale
deactivate Reader

Runner -> Runner : Choix Stratégie (Mono/Multi)
create Updater
Runner -> Updater : new Single/MultiThreadUpdater()

create Game
Runner -> Game : new Game(grid, rule, updater)

Runner -> Runner : benchmarkRun()
activate Runner

loop Pour chaque itération

    Runner -> Game : nextStep()
    activate Game
    
    Game -> Updater : update(grid, rule)
    activate Updater
    
    Updater -> Updater : Prépare grille tampon
    
    loop Pour chaque cellule (x,y)
        Updater -> Grid : countLivingNeighbours(x,y)
        activate Grid
        Grid --> Updater : nb_voisins
        deactivate Grid
        
        Updater -> Rule : willBeAlive(etat, nb_voisins)
        activate Rule
        Rule --> Updater : vivant/mort
        deactivate Rule
        
        Updater -> Updater : Ecrit dans tampon
    end
    
    Updater -> Grid : swap(tampon)
    activate Grid
    Grid --> Updater : Grille mise à jour
    deactivate Grid
    
    Updater --> Game : Fin mise à jour
    deactivate Updater
    
    Game --> Runner : Etape terminée
    deactivate Game
    
    Runner -> Writer : write(grid, "out_N.txt")
    activate Writer
    Writer --> Runner : Fichier écrit
    deactivate Writer

end

deactivate Runner
deactivate Runner

@enduml
